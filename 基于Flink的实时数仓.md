# 1 科杰大数据解决方案 - 基于Flink构建实时数仓

[link 基于Flink构建实时数仓](https://zhuanlan.zhihu.com/p/192789482)

Q1

1、 ODS层：以Kafka为支撑，将所有需要实时处理的相关数据放到Kafka队列中来实现贴源数据层；

2、 DWD层：实时计算订阅业务数据消息队列，然后通过数据清洗、多数据源join、流式数据与离线维度信息等的组合，将一些相同粒度的业务系统、维表中的维度属性全部关联到一起，增加数据易用性和复用性，得到最终的实时明细数据；
3、 DIM层：存放用于关联查询的维度信息，可以根据数据现状来选择存储介质，例如使用HBase或者Mysql

4、 DWS层：轻度汇总层是为了便于面向AdHoc查询或者Olap分析构建的轻度汇总结果集合，适合数据维度、指标信息比较多的情况，为了方便根据自定义条件的快速筛选和指标聚合，推荐使用MPP类型数据库进行存储，此层可视场景情况决定是否构建；

5、 APP层：面向实时数据场景需求构建的高度汇总层，可以根据不通的数据应用场景决定使用存储介质或者引擎；例如面向业务历史明细、BI支持等Olap分析场景，可以使用Druid、Greenplum，面向实时监控大屏、高并发汇总指标等需求，可以使用KV模式的HBase；数据量较小的时候，也可以使用Mysql来进行存储。

这里要注意下，其实APP层已经脱离了数仓，这里虽然作为了数仓的独立分层，但是实际APP层的数据已经分布存储在各种介质中用于使用。

Q2

我们在看看FlinkSql有哪些优势呢，我们从四方面去看；第一，支持 ANSI SQL 的标准；第二，丰富的数据类型与函数支持，包括常见的算术运算与聚合运算；第三，可自定义 Source/Sink，基于此可以灵活地扩展上下游；第四，使用SQL进行数据处理，技术门槛要低于Jar的开发，批流SQL可以进行有效的快速转换。

S3

推荐了其实施平台, 类似阿里的 Realtime. 

元数据管理, 基于WEB的IDE开发, 任务作业管理, 可视化集群大屏监控



# 2 基于 Flink + Hive 构建流批一体准实时数仓

https://developer.aliyun.com/article/774843

简单来说就是把 Kafka 表的元数据信息存储到 HiveMetaStore 中，做到离线和实时的表 Meta 的统一。

我们知道 Flink 是支持维表关联查询 MySQL 和 HBase 的，在计算中维护一个 LRU 的缓存，未命中查询 MySQL 或 HBase。但是没有 Lookup 的能力怎么办呢？数据一般是放在离线数仓中的，所以业务上我们一般采用 Hive Table 定期同步到 HBase 或者 MySQL。Flink 也可以允许直接维表关联 Hive 表，目前的实现很简单，需要在每个并发中全量 Load Hive 表的所有数据，只能针对小表的关联。